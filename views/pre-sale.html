<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="verify-admitad" content="c8275d0683" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <title>{{.Name}} – Promo Eksklusif</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: "Segoe UI", sans-serif;
            height: 100vh;
            background: url("https://images.pexels.com/photos/5872364/pexels-photo-5872364.jpeg?_gl=1*re42po*_ga*MTQzMDQ3NzA1LjE3NTcwOTkyMDc.*_ga_8JE65Q40S6*czE3NTcwOTkyMDYkbzEkZzEkdDE3NTcwOTkzNTkkajIkbDAkaDA.") no-repeat center center fixed;
            background-size: cover;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
        }

        .overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
        }

        .card {
            position: relative;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
            text-align: center;
            max-width: 480px;
            z-index: 1;
        }

        .card img {
            max-width: 100%;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        h1 {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: #333;
        }

        p {
            color: #555;
            margin-bottom: 20px;
        }

        .btn {
            display: inline-block;
            padding: 12px 24px;
            background: #ff5722;
            color: #fff;
            font-weight: bold;
            text-decoration: none;
            border-radius: 8px;
            transition: 0.3s;
            text-align: center;
        }

        .btn:hover {
            background: #e64a19;
        }

        @media (max-width: 600px) {
            body {
                padding: 8px;
            }

            .card {
                width: 96%;
                max-width: 96%;
                padding: 18px;
                border-radius: 12px;
                box-shadow: 0 4px 14px rgba(0, 0, 0, 0.25);
            }

            h1 {
                font-size: 1.2rem;
            }
        }

        .btn {
            display: inline-block;
            padding: 14px 24px;
            background: linear-gradient(45deg, #ff5722, #ff9800);
            color: #fff;
            font-weight: bold;
            font-size: 18px;
            border: none;
            border-radius: 8px;
            text-decoration: none;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.3s ease;
            animation: pulse 2s infinite;
            text-align: center;
        }

        .btn:hover {
            transform: scale(1.08);
            box-shadow: 0 6px 18px rgba(255, 87, 34, 0.5);
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(255, 87, 34, 0.6);
            }
            70% {
                box-shadow: 0 0 0 15px rgba(255, 87, 34, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(255, 87, 34, 0);
            }
        }

        /* Add some utility styles */
        .countdown {
            display: inline-block;
            background: #1b5e20;
            color: #fff;
            padding: 6px 12px;
            border-radius: 999px;
            font-weight: 600;
            font-size: 14px;
            letter-spacing: 0.5px;
            margin-bottom: 14px;
        }

        .badges {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 12px;
            flex-wrap: wrap;
        }

        .badge {
            background: rgba(0, 0, 0, 0.06);
            color: #333;
            border: 1px solid rgba(0, 0, 0, 0.08);
            border-radius: 999px;
            padding: 6px 10px;
            font-size: 12px;
        }

        .benefits {
            text-align: left;
            margin: 12px 0 18px;
            color: #333;
        }

        .benefits li {
            margin: 6px 0;
        }

        .sticky-cta {
            position: fixed;
            left: 0;
            right: 0;
            bottom: 16px;
            display: none;
            justify-content: center;
            z-index: 2;
        }

        .sticky-cta .btn {
            box-shadow: 0 10px 24px rgba(255, 87, 34, 0.5);
        }

        @media (max-width: 600px) {
            .sticky-cta {
                display: flex;
            }
        }

        /* Shopee-like item card image section */
        .ItemCard__imageSection {
            position: relative;
            width: 100%;
            margin: 12px 0 16px;
            border-radius: 12px;
            overflow: hidden;
            background: #fff;
            box-shadow: 0 4px 14px rgba(0,0,0,0.12);
        }
        .ItemCard__imageSection .ItemCard__image {
            width: 100%;
            aspect-ratio: 1 / 1;
            background: #f7f7f7;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .ItemCard__imageSection .ItemCard__image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }
        .ItemCard__imageSection .ItemCard__flags {
            position: absolute;
            top: 8px;
            left: 8px;
            display: flex;
            gap: 6px;
            z-index: 2;
        }
        .ItemCardFlag {
            padding: 4px 8px;
            font-size: 12px;
            border-radius: 6px;
            color: #fff;
            background: linear-gradient(135deg, #ee4d2d, #ff7345);
            box-shadow: 0 2px 6px rgba(238, 77, 45, 0.4);
            font-weight: 700;
        }
        .ItemCardFlag--mall--id::before {
            content: "Mall";
        }
        .ItemCard__badges {
            position: absolute;
            bottom: 8px;
            left: 8px;
            right: 8px;
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
            z-index: 2;
        }
        .ItemCard__badge {
            background: rgba(0,0,0,0.6);
            color: #fff;
            font-size: 11px;
            padding: 3px 6px;
            border-radius: 4px;
        }
        .ItemCard__badge {
            background: rgba(0,0,0,0.6);
            color: #fff;
            font-size: 11px;
            padding: 3px 6px;
            border-radius: 4px;
        }

        /* Responsive enhancements */
        .card { width: min(92vw, 900px); max-width: 900px; }
        .card__grid { display: block; }
        .card__main { text-align: left; }

        @media (min-width: 768px) {
            .card__grid { display: grid; grid-template-columns: 1fr 1.1fr; gap: 20px; align-items: start; }
            .card { padding: 32px 36px; }
        }

        h2 { font-size: clamp(1.2rem, 2.4vw, 1.9rem); margin: 10px 0; color:#333; }
        p#desc { font-size: clamp(0.95rem, 1.6vw, 1.05rem); color:#555; }
        .btn { font-size: clamp(16px, 2.2vw, 18px); padding: clamp(12px, 2.2vw, 14px) 24px; }

        .sticky-cta { padding-bottom: max(16px, env(safe-area-inset-bottom)); }
        @media (max-width: 767px) { .sticky-cta { display: flex; } }

        @media (prefers-reduced-motion: reduce) {
            .btn { animation: none !important; transition: none !important; }
        }

        .autoNote { margin-top:8px; color:#666; font-size:13px; }

        /* Fix background-attachment for mobile */
        @media (max-width: 767px) { body { background-attachment: scroll; } }
        @media (min-width: 768px) { body { background-attachment: fixed; } }

        /* Center primary CTA on larger screens */
        .card__main > .btn { display: block; margin: 12px auto; }

        /* Hide inline CTA on small screens to avoid duplicate with sticky CTA */
        @media (max-width: 600px) {
            .card__main > .btn { display: none; }
        }
    </style>
</head>
<body>
<div class="overlay" aria-hidden="true"></div>
<div class="card" role="dialog" aria-labelledby="title" aria-describedby="desc">
    <div class="countdown" id="countdown">Berakhir dalam 10:00</div>
    <div class="card__grid">
        {{if .Image}}
        <div class="ItemCard__imageSection" aria-hidden="false">
            <div class="ItemCard__flags">
                <div class="ItemCardFlag ItemCardFlag--mall ItemCardFlag--mall--id"></div>
            </div>
            <div class="ItemCard__badges"></div>
            <div class="ItemCard__image">
                <img src="{{.Image}}" alt="">
            </div>
        </div>
        {{end}}
        <div class="card__main">
            <h2 id="title">🔥 {{.Name}} Promo Spesial! 🔥</h2>
            <p id="desc">Klik tombol atau di mana saja untuk lanjut & dapatkan penawaran terbaik sekarang juga!</p>
            <ul class="benefits">
                <li>💥 Diskon eksklusif hari ini</li>
                <li>🛡 Garansi toko resmi</li>
                <li>⚡ Stok terbatas — jangan sampai kehabisan</li>
            </ul>
            <a id="buyBtn" class="btn" href="#" role="button" aria-label="Beli sekarang"> 👉 Beli Sekarang</a>
            <div id="autoNote" class="autoNote">Akan otomatis lanjut dalam 15 detik…</div>
            <div class="badges" aria-hidden="true">
                <span class="badge">✔ Checkout Aman</span>
                <span class="badge">⭐ 4.9/5 Rating</span>
                <span class="badge">🚀 Proses Cepat</span>
            </div>
        </div>
    </div>
</div>
<div class="sticky-cta">
    <a id="buyBtnSticky" class="btn" href="#">Beli Sekarang</a>
</div>
<script>
    const params = new URLSearchParams(window.location.search);
    const filteredParams = new URLSearchParams();

    // Preserve existing query parameters (except product)
    params.forEach((value, key) => {
        if (key !== "product") {
            filteredParams.append(key, value);
        }
    });

    // Add referrer information if available for tracking
    if (document.referrer && !filteredParams.has('ref')) {
        try {
            const refUrl = new URL(document.referrer);
            if (refUrl.hostname !== window.location.hostname) {
                filteredParams.append('ref', refUrl.hostname);
            }
        } catch (e) {
            // Ignore invalid referrer URLs
        }
    }

    // Add pre-sale flag to indicate this came from pre-sale page
    filteredParams.append('from', 'presale');

    const queryString = filteredParams.toString();
    const redirectUrl = queryString ? "/?product={{.ID}}&" + queryString : "/?product={{.ID}}";

    // Countdown timer: default 10 minutes; allow override via ?expires=<unix_ms>
    const countdownEl = document.getElementById('countdown');
    (function initCountdown() {
        let endTs = parseInt(params.get('expires') || '0', 10);
        if (!endTs || isNaN(endTs)) {
            endTs = Date.now() + 10 * 60 * 1000; // 10 minutes default
        }

        function fmt(ms) {
            const s = Math.max(0, Math.floor(ms / 1000));
            const m = String(Math.floor(s / 60)).padStart(2, '0');
            const r = String(s % 60).padStart(2, '0');
            return m + ':' + r;
        }

        function tick() {
            const left = endTs - Date.now();
            if (left <= 0) {
                countdownEl.textContent = 'Segera berakhir!';
                clearInterval(iv);
                return;
            }
            countdownEl.textContent = 'Berakhir dalam ' + fmt(left);
        }

        tick();
        const iv = setInterval(tick, 1000);
    })();

    function go() {
        window.location.href = redirectUrl;
    }

    // Navigate without adding a new history entry (so Back won't return here)
    function goReplace() {
        window.location.replace(redirectUrl);
    }

    document.addEventListener('click', function (e) {
        const path = e.composedPath ? e.composedPath() : [];
        const isInteractive = path.some(el => el && el.tagName && ['A', 'BUTTON', 'INPUT', 'SELECT', 'TEXTAREA'].includes(el.tagName));
        if (!isInteractive) {
            go();
        }
    });

    function wireCTA(btn) {
        if (!btn) return;
        btn.addEventListener('click', function (e) {
            e.preventDefault();
            go();
        });
        // Support keyboard activation
        btn.addEventListener('keydown', function (e) {
            if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                go();
            }
        });
        // Allow middle-click to open in same tab by just navigating (we prevent default above anyway)
        btn.addEventListener('auxclick', function (e) {
            e.preventDefault();
            go();
        });
    }

    document.addEventListener('DOMContentLoaded', function () {
        wireCTA(document.getElementById('buyBtn'));
        wireCTA(document.getElementById('buyBtnSticky'));
    });

    // Auto-redirect after N seconds (default 5). Override with ?auto=3 or ?auto=5
    (function initAutoRedirect() {
        const note = document.getElementById('autoNote');
        let left = Math.max(1, parseInt(params.get('auto') || '15', 10));

        function render() {
            if (note) note.textContent = `Akan otomatis lanjut dalam ${left} detik…`;
        }

        render();
        let timer = setInterval(() => {
            left -= 1;
            render();
            if (left <= 0) {
                clearInterval(timer);
                goReplace();
            }
        }, 1000);
    })();

    console.log('Redirect URL:', redirectUrl);
</script>

</body>
</html>
